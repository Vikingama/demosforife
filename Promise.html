<!DOCTYPE html>
<html>
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <meta http-equiv="X-UA-Compatible" content="ie=edge" />
    <title>Promise/Async/Await</title>
  </head>
  <body>
    Promise 是一个构造函数，使用时要 new Promise(x) 来构造一个对象，其中的 x
    是一个函数，(resolve, reject) => {异步代码返回
    data}，在函数中执行异步代码，如果异步执行成功，则调用
    resolve(data)，错误则调用 reject(data)...
    <hr />
    Promise.resolve() 执行成功
    <hr />
    Promise.reject() 执行失败
    <hr />
    Promise.then() 递延处理
    <hr />
    Promise.all() 所有的完成，常被用于处理多个 Promise 对象的状态集合
    <hr />
    使用 async/await 时，在主体函数前使用 async，表示这是个异步函数，await
    只能使用在 async 函数内部。当函数执行的时候，一旦遇到 await
    就会先返回，等到异步操作完成，再接着执行函数体内后面的语句。示例中，await
    getJSON() 说明 console.log 的调用，会等到 getJSON() 返回的 Promise 对象
    resolve 之后触发
  </body>
  <script>
    let samplePromise = new Promise((resolve, reject) => {
      setTimeout(() => {
        resolve('Bingo...');
      }, 3333);
    }).then(data => {
      console.log(data);
    });
    getJSON = () => {
      return new Promise((resolve, reject) => {
        setTimeout(() => {
          resolve({
            name: 'VKX',
            age: 25,
            sex: 'MAN'
          });
        }, 3333);
      });
    };
    // const makeRequest = () => {
    //     getJSON().then(data => {
    //         console.log(data);
    //         return "done";
    //     });
    // };
    // makeRequest();
    const makeRequest = async () => {
      console.log(await getJSON());
      return 'done';
    };
    makeRequest();
  </script>
</html>
